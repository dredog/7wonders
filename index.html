<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>7 Wonders Duel</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; font-family: 'Cinzel', serif; }
        button { font-family: 'Cinzel', serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
const { useState } = React;

const ResourceIcon = ({ type }) => {
  const icons = {
    wood: 'ğŸªµ',
    clay: 'ğŸ§±', 
    stone: 'ğŸª¨',
    glass: 'ğŸ”®',
    papyrus: 'ğŸ“œ'
  };
  return <span>{icons[type] || type}</span>;
};

const CARDS_AGE1 = [
  { id: 1, name: 'Lumber Yard', type: 'brown', cost: {}, prod: { wood: 1 }},
  { id: 2, name: 'Clay Pool', type: 'brown', cost: {}, prod: { clay: 1 }},
  { id: 3, name: 'Quarry', type: 'brown', cost: {}, prod: { stone: 1 }},
  { id: 4, name: 'Glassworks', type: 'gray', cost: { coin: 1 }, prod: { glass: 1 }},
  { id: 5, name: 'Press', type: 'gray', cost: { coin: 1 }, prod: { papyrus: 1 }},
  { id: 6, name: 'Guard Tower', type: 'red', cost: { clay: 1 }, mil: 1 },
  { id: 7, name: 'Stable', type: 'red', cost: { wood: 1 }, mil: 1 },
  { id: 8, name: 'Baths', type: 'blue', cost: { stone: 1 }, pts: 3 },
  { id: 9, name: 'Altar', type: 'blue', cost: {}, pts: 3 },
  { id: 10, name: 'Theater', type: 'blue', cost: {}, pts: 3 },
  { id: 11, name: 'Workshop', type: 'green', cost: { papyrus: 1 }, sci: 'wheel' },
  { id: 12, name: 'Apothecary', type: 'green', cost: { glass: 1 }, sci: 'compass' },
  { id: 13, name: 'Tavern', type: 'yellow', cost: {}, coins: 4 },
  { id: 14, name: 'Logging Camp', type: 'brown', cost: { coin: 1 }, prod: { wood: 1 }},
  { id: 15, name: 'Clay Pit', type: 'brown', cost: { coin: 1 }, prod: { clay: 1 }},
  { id: 16, name: 'Stone Pit', type: 'brown', cost: { coin: 1 }, prod: { stone: 1 }},
  { id: 17, name: 'Garrison', type: 'red', cost: { clay: 1 }, mil: 1 },
  { id: 18, name: 'Palisade', type: 'red', cost: { coin: 2 }, mil: 1 },
  { id: 19, name: 'Scriptorium', type: 'green', cost: { papyrus: 1 }, sci: 'tablet' },
  { id: 20, name: 'Marketplace', type: 'yellow', cost: {}, trade: true },
];

const shuffle = arr => [...arr].sort(() => Math.random() - 0.5);

const PYRAMID = [
  { r: 0, c: 0, up: true },
  { r: 1, c: 0, up: false }, { r: 1, c: 1, up: false },
  { r: 2, c: 0, up: true }, { r: 2, c: 1, up: true }, { r: 2, c: 2, up: true },
  { r: 3, c: 0, up: false }, { r: 3, c: 1, up: false }, { r: 3, c: 2, up: false }, { r: 3, c: 3, up: false },
  { r: 4, c: 0, up: true }, { r: 4, c: 1, up: true }, { r: 4, c: 2, up: true }, { r: 4, c: 3, up: true }, { r: 4, c: 4, up: true },
  { r: 5, c: 0, up: false }, { r: 5, c: 1, up: false }, { r: 5, c: 2, up: false }, { r: 5, c: 3, up: false }, { r: 5, c: 4, up: false }, { r: 5, c: 5, up: false },
];

function App() {
  const [game, setGame] = useState(null);
  const [sel, setSel] = useState(null);

  const init = () => {
    const cards = shuffle(CARDS_AGE1);
    const pyr = PYRAMID.map((p, i) => ({ ...p, card: cards[i], taken: false }));
    setGame({
      pyr,
      p1: { coins: 7, cards: [], mil: 0 },
      p2: { coins: 7, cards: [], mil: 0 },
      turn: 1,
      msg: 'Player 1 - pick a card'
    });
  };

  if (!game) {
    return (
      <div style={{minHeight:'100vh',background:'linear-gradient(135deg,#2c1810,#6b4423)',display:'flex',alignItems:'center',justifyContent:'center',color:'#f4e4c1',padding:'20px'}}>
        <div style={{textAlign:'center'}}>
          <h1 style={{fontSize:'2.5rem',marginBottom:'30px'}}>7 Wonders Duel</h1>
          <button onClick={init} style={{padding:'15px 40px',fontSize:'1.3rem',background:'linear-gradient(135deg,#8b6914,#c9a227)',border:'2px solid #f4e4c1',borderRadius:'8px',color:'#2c1810',fontWeight:'bold',cursor:'pointer'}}>
            Start Game
          </button>
        </div>
      </div>
    );
  }

  const isAccessible = (pos) => {
    if (pos.taken) return false;
    const below = game.pyr.filter(p => p.r === pos.r + 1 && (p.c === pos.c || p.c === pos.c + 1) && !p.taken);
    return below.length === 0;
  };

  const canAfford = (card, player) => {
    let cost = card.cost?.coin || 0;
    // Simplified: just check coins
    return player.coins >= cost;
  };

  const build = (pos) => {
    const card = pos.card;
    const p = game.turn === 1 ? game.p1 : game.p2;
    
    if (!canAfford(card, p)) {
      setGame({...game, msg: 'Cannot afford!'});
      return;
    }

    const newP = {...p};
    newP.coins -= (card.cost?.coin || 0);
    newP.cards.push(card);
    if (card.mil) newP.mil += card.mil;
    if (card.coins) newP.coins += card.coins;
    
    const newPyr = game.pyr.map(x => x === pos ? {...x, taken: true} : x)
      .map(x => !x.up && isAccessible(x) ? {...x, up: true} : x);

    const nextTurn = game.turn === 1 ? 2 : 1;
    
    if (game.turn === 1) {
      setGame({...game, pyr: newPyr, p1: newP, turn: nextTurn, msg: `Player ${nextTurn}'s turn`});
    } else {
      setGame({...game, pyr: newPyr, p2: newP, turn: nextTurn, msg: `Player ${nextTurn}'s turn`});
    }
    
    setSel(null);
  };

  const discard = (pos) => {
    const p = game.turn === 1 ? game.p1 : game.p2;
    const newP = {...p, coins: p.coins + 2};
    
    const newPyr = game.pyr.map(x => x === pos ? {...x, taken: true} : x)
      .map(x => !x.up && isAccessible(x) ? {...x, up: true} : x);

    const nextTurn = game.turn === 1 ? 2 : 1;
    
    if (game.turn === 1) {
      setGame({...game, pyr: newPyr, p1: newP, turn: nextTurn, msg: `Player ${nextTurn}'s turn`});
    } else {
      setGame({...game, pyr: newPyr, p2: newP, turn: nextTurn, msg: `Player ${nextTurn}'s turn`});
    }
    
    setSel(null);
  };

  const getColor = (type) => {
    const cols = { brown: '#8b4513', gray: '#708090', red: '#b22222', green: '#228b22', blue: '#1e90ff', yellow: '#ffd700' };
    return cols[type] || '#666';
  };

  return (
    <div style={{minHeight:'100vh',background:'linear-gradient(135deg,#2c1810,#6b4423)',color:'#f4e4c1',padding:'20px'}}>
      <h2 style={{textAlign:'center',marginBottom:'10px'}}>Age 1</h2>
      <div style={{textAlign:'center',background:'rgba(139,105,20,0.3)',padding:'10px',borderRadius:'6px',marginBottom:'20px'}}>
        {game.msg}
      </div>

      <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px',marginBottom:'20px'}}>
        <div style={{background:'rgba(0,0,0,0.3)',border:`2px solid ${game.turn===1?'#c9a227':'#666'}`,borderRadius:'8px',padding:'15px'}}>
          <h3 style={{margin:'0 0 10px 0'}}>Player 1 {game.turn===1 && 'â­'}</h3>
          <div>ğŸ’° {game.p1.coins} | âš”ï¸ {game.p1.mil} | Cards: {game.p1.cards.length}</div>
        </div>
        <div style={{background:'rgba(0,0,0,0.3)',border:`2px solid ${game.turn===2?'#c9a227':'#666'}`,borderRadius:'8px',padding:'15px'}}>
          <h3 style={{margin:'0 0 10px 0'}}>Player 2 {game.turn===2 && 'â­'}</h3>
          <div>ğŸ’° {game.p2.coins} | âš”ï¸ {game.p2.mil} | Cards: {game.p2.cards.length}</div>
        </div>
      </div>

      <div style={{background:'rgba(0,0,0,0.3)',borderRadius:'8px',padding:'20px',marginBottom:'20px'}}>
        <h3 style={{textAlign:'center',marginBottom:'15px'}}>Pyramid</h3>
        <div style={{display:'flex',flexDirection:'column',gap:'12px',alignItems:'center'}}>
          {[...Array(6)].map((_, r) => {
            const row = game.pyr.filter(p => p.r === r);
            return (
              <div key={r} style={{display:'flex',gap:'12px'}}>
                {row.map((pos, i) => {
                  const acc = isAccessible(pos);
                  if (pos.taken) return <div key={i} style={{width:'110px',height:'150px',opacity:0.2}}></div>;
                  return (
                    <div key={i} onClick={() => acc && setSel(pos)} style={{
                      width:'110px',height:'150px',background:pos.up?getColor(pos.card.type):'#3a2414',
                      border:`3px solid ${sel===pos?'#ffd700':acc?'#c9a227':'#666'}`,
                      borderRadius:'8px',cursor:acc?'pointer':'not-allowed',opacity:acc?1:0.5,
                      display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',
                      padding:'8px',textAlign:'center',color:'#fff',fontSize:'0.8rem'
                    }}>
                      {pos.up ? (
                        <>
                          <div style={{fontWeight:'bold',marginBottom:'6px',fontSize:'0.85rem'}}>{pos.card.name}</div>
                          {pos.card.cost && Object.keys(pos.card.cost).length > 0 && (
                            <div style={{marginBottom:'4px'}}>
                              {Object.entries(pos.card.cost).map(([r,a]) => (
                                <span key={r} style={{marginRight:'4px'}}>
                                  {r==='coin'?`ğŸ’°${a}`:<><ResourceIcon type={r}/>{a}</>}
                                </span>
                              ))}
                            </div>
                          )}
                          {pos.card.prod && (
                            <div style={{background:'rgba(255,255,255,0.2)',padding:'3px 6px',borderRadius:'4px',marginBottom:'4px'}}>
                              {Object.entries(pos.card.prod).map(([r,a]) => (
                                <span key={r}><ResourceIcon type={r}/> Ã—{a}</span>
                              ))}
                            </div>
                          )}
                          <div style={{display:'flex',gap:'4px'}}>
                            {pos.card.pts && <span>â˜…{pos.card.pts}</span>}
                            {pos.card.mil && <span>âš”ï¸{pos.card.mil}</span>}
                            {pos.card.coins && <span>+{pos.card.coins}ğŸ’°</span>}
                          </div>
                        </>
                      ) : '?'}
                    </div>
                  );
                })}
              </div>
            );
          })}
        </div>
      </div>

      {sel && (
        <div style={{background:'rgba(139,105,20,0.4)',border:'2px solid #c9a227',borderRadius:'8px',padding:'20px'}}>
          <h3>Selected: {sel.card.name}</h3>
          <div style={{display:'flex',gap:'10px',flexWrap:'wrap',marginTop:'15px'}}>
            <button onClick={() => build(sel)} style={{
              padding:'12px 25px',fontSize:'1.1rem',background:'#228b22',border:'2px solid #f4e4c1',
              borderRadius:'6px',color:'#fff',fontWeight:'bold',cursor:'pointer'
            }}>
              Build Card
            </button>
            <button onClick={() => discard(sel)} style={{
              padding:'12px 25px',fontSize:'1.1rem',background:'#666',border:'2px solid #f4e4c1',
              borderRadius:'6px',color:'#fff',fontWeight:'bold',cursor:'pointer'
            }}>
              Discard (+2ğŸ’°)
            </button>
            <button onClick={() => setSel(null)} style={{
              padding:'12px 25px',fontSize:'1.1rem',background:'#8b4513',border:'2px solid #f4e4c1',
              borderRadius:'6px',color:'#fff',fontWeight:'bold',cursor:'pointer'
            }}>
              Cancel
            </button>
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
